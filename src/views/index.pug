doctype html
html(lang="pt-br")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    title Heranças do Sul
    link(rel="stylesheet", href="/css/style.css")

  body
    header
      .header-content
        img(src="/img/logo.png", alt="Logo Heranças do Sul", class="logo-header")
        .search-bar
          input(type="text", placeholder="Pesquisar produtos...")
          button Pesquisar
        nav.header-nav
          a(href="/carrinho")
            button Carrinho

          if !usuario || !usuario.usuarioId || !usuario.tipo
            a(href="/login")
              button Entrar
            a(href="/usuarios/novo")
              button Cadastrar-se
          else
            if usuario.tipo === 'admin'
              a(href="/categorias/nova")
                button Cadastrar Categoria
              a(href="/produtos/novo")
                button Cadastrar Produto
              a(href="/perfil-admin")
                button.perfil-btn
                  if usuario.fotoPerfil
                    img(src=usuario.fotoPerfil, alt="Perfil", class="perfil-icon")
                  else
                    img(src="/img/user.png", alt="Perfil", class="perfil-icon")
            else
              a(href="/perfil")
                button.perfil-btn
                  if usuario.fotoPerfil
                    img(src=usuario.fotoPerfil, alt="Perfil", class="perfil-icon")
                  else
                    img(src="/img/user.png", alt="Perfil", class="perfil-icon")

    nav.main-nav
      .dropdown
        button.dropbtn Categorias
        .dropdown-content
          each cat in categorias
            a(href="/produtos/categoria/#{cat.id}")= cat.nome

      a(href="/produtos/novidades")
        button Novidades
      a(href="/produtos/descontos")
        button Descontos
      a(href="/produtos/populares")
        button Populares

    main
      if mensagemSucesso
        .alert-success= mensagemSucesso

      //- Grid de produtos
      .produtos-grid
        each produto in produtos
          .produto-card
            img(src=produto.imagens && JSON.parse(produto.imagens)[0] || '/img/placeholder.png', alt=produto.nome)
            h3= produto.nome
            p.preco R$ #{produto.preco.toFixed(2)}
            if produto.desconto > 0
              p.desconto Desconto: #{produto.desconto} %
            form(action="/carrinho/adicionar/" + produto.id, method="post", style="display:flex; gap:10px; justify-content:center;")
              button(type="submit") Adicionar ao Carrinho
              if usuario && usuario.tipo === 'admin'
                form(action="/produtos/deletar/" + produto.id, method="post")
                  button(type="submit", class="admin-btn") Excluir Produto

    .footer-bar
      | 48 98868-6376
